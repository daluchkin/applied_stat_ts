<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 ETS model variations | Applied statistics: Time series analysis</title>
  <meta name="description" content="Chapter 3 ETS model variations | Applied statistics: Time series analysis" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 ETS model variations | Applied statistics: Time series analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="https://github.com/daluchkin/applied_stat_ts" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 ETS model variations | Applied statistics: Time series analysis" />
  
  
  

<meta name="author" content="Dmitry Luchkin" />


<meta name="date" content="2024-12-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exponential-smoothing-models.html"/>
<link rel="next" href="stationary-process.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://www.youtube.com/@%D0%9F%D1%80%D0%B8%D0%BA%D0%BB%D0%B0%D0%B4%D0%BD%D0%B0%D1%8F%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D0%BA%D0%B0/playlists">Time Series Analysis (Lectures)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html"><i class="fa fa-check"></i><b>1</b> Components of time series and naive models</a>
<ul>
<li class="chapter" data-level="1.1" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#what-is-time-series"><i class="fa fa-check"></i><b>1.1</b> What is time series?</a></li>
<li class="chapter" data-level="1.2" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#time-series-components"><i class="fa fa-check"></i><b>1.2</b> Time Series Components</a></li>
<li class="chapter" data-level="1.3" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#algorithm-stl"><i class="fa fa-check"></i><b>1.3</b> Algorithm STL</a></li>
<li class="chapter" data-level="1.4" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#time-series-characteristics"><i class="fa fa-check"></i><b>1.4</b> Time Series Characteristics</a>
<ul>
<li class="chapter" data-level="" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#acf"><i class="fa fa-check"></i>ACF</a></li>
<li class="chapter" data-level="" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#pacf"><i class="fa fa-check"></i>PACF</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#simple-models"><i class="fa fa-check"></i><b>1.5</b> Simple Models</a>
<ul>
<li class="chapter" data-level="" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#white-noise"><i class="fa fa-check"></i>White Noise</a></li>
<li class="chapter" data-level="" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#model-with-independent-observations"><i class="fa fa-check"></i>Model with independent observations</a></li>
<li class="chapter" data-level="" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#naive-model-random-walk"><i class="fa fa-check"></i>Naive Model (Random Walk)</a></li>
<li class="chapter" data-level="" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#seasonal-random-walk"><i class="fa fa-check"></i>Seasonal Random Walk</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#examples"><i class="fa fa-check"></i><b>1.6</b> Examples</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#time-series-from-scratch"><i class="fa fa-check"></i><b>1.6.1</b> Time series from scratch</a></li>
<li class="chapter" data-level="1.6.2" data-path="components-of-time-series-and-naive-models.html"><a href="components-of-time-series-and-naive-models.html#time-series-data-cleaning"><i class="fa fa-check"></i><b>1.6.2</b> Time Series data cleaning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html"><i class="fa fa-check"></i><b>2</b> Exponential smoothing models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#etsann-model"><i class="fa fa-check"></i><b>2.1</b> ETS(ANN) model</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#forecast"><i class="fa fa-check"></i><b>2.1.1</b> Forecast</a></li>
<li class="chapter" data-level="2.1.2" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#example"><i class="fa fa-check"></i><b>2.1.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#etsaan-model"><i class="fa fa-check"></i><b>2.2</b> ETS(AAN) model</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#forecast-1"><i class="fa fa-check"></i><b>2.2.1</b> Forecast</a></li>
<li class="chapter" data-level="2.2.2" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#example-1"><i class="fa fa-check"></i><b>2.2.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#etsaaa-model"><i class="fa fa-check"></i><b>2.3</b> ETS(AAA) model</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#forecast-2"><i class="fa fa-check"></i><b>2.3.1</b> Forecast</a></li>
<li class="chapter" data-level="2.3.2" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#example-2"><i class="fa fa-check"></i><b>2.3.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#model-selection"><i class="fa fa-check"></i><b>2.4</b> Model selection</a>
<ul>
<li class="chapter" data-level="" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#mean-absolute-error"><i class="fa fa-check"></i>Mean Absolute Error</a></li>
<li class="chapter" data-level="" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#root-mean-squared-error"><i class="fa fa-check"></i>Root Mean Squared Error</a></li>
<li class="chapter" data-level="" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#mean-absolute-percentage-error"><i class="fa fa-check"></i>Mean Absolute Percentage Error</a></li>
<li class="chapter" data-level="" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#symmetric-mean-absolute-percentage-error"><i class="fa fa-check"></i>Symmetric Mean Absolute Percentage Error</a></li>
<li class="chapter" data-level="" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#mean-absolute-scaled-error"><i class="fa fa-check"></i>Mean Absolute Scaled Error</a></li>
<li class="chapter" data-level="" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#akaike-information-criterion"><i class="fa fa-check"></i>Akaike Information Criterion</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#examples-1"><i class="fa fa-check"></i><b>2.5</b> Examples</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#model-selection-by-mse"><i class="fa fa-check"></i><b>2.5.1</b> Model selection by MSE</a></li>
<li class="chapter" data-level="2.5.2" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#model-averaging"><i class="fa fa-check"></i><b>2.5.2</b> Model Averaging</a></li>
<li class="chapter" data-level="2.5.3" data-path="exponential-smoothing-models.html"><a href="exponential-smoothing-models.html#cross-validation"><i class="fa fa-check"></i><b>2.5.3</b> Cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ets-model-variations.html"><a href="ets-model-variations.html"><i class="fa fa-check"></i><b>3</b> ETS model variations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ets-model-variations.html"><a href="ets-model-variations.html#etsaadn-damped-trend"><i class="fa fa-check"></i><b>3.1</b> ETS(AAdN): damped trend</a>
<ul>
<li class="chapter" data-level="" data-path="ets-model-variations.html"><a href="ets-model-variations.html#forecast-3"><i class="fa fa-check"></i>Forecast</a></li>
<li class="chapter" data-level="" data-path="ets-model-variations.html"><a href="ets-model-variations.html#example-3"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ets-model-variations.html"><a href="ets-model-variations.html#etsmnm-multiplicative-components"><i class="fa fa-check"></i><b>3.2</b> ETS(MNM): multiplicative components</a>
<ul>
<li class="chapter" data-level="" data-path="ets-model-variations.html"><a href="ets-model-variations.html#parameters"><i class="fa fa-check"></i>Parameters</a></li>
<li class="chapter" data-level="" data-path="ets-model-variations.html"><a href="ets-model-variations.html#forecast-4"><i class="fa fa-check"></i>Forecast</a></li>
<li class="chapter" data-level="" data-path="ets-model-variations.html"><a href="ets-model-variations.html#example-4"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ets-model-variations.html"><a href="ets-model-variations.html#etsmadm-combinations"><i class="fa fa-check"></i><b>3.3</b> ETS(MAdM): combinations</a>
<ul>
<li class="chapter" data-level="" data-path="ets-model-variations.html"><a href="ets-model-variations.html#parameters-1"><i class="fa fa-check"></i>Parameters</a></li>
<li class="chapter" data-level="" data-path="ets-model-variations.html"><a href="ets-model-variations.html#forecast-5"><i class="fa fa-check"></i>Forecast</a></li>
<li class="chapter" data-level="" data-path="ets-model-variations.html"><a href="ets-model-variations.html#example-5"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ets-model-variations.html"><a href="ets-model-variations.html#examples-2"><i class="fa fa-check"></i><b>3.4</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stationary-process.html"><a href="stationary-process.html"><i class="fa fa-check"></i><b>4</b> Stationary Process</a>
<ul>
<li class="chapter" data-level="4.1" data-path="stationary-process.html"><a href="stationary-process.html#ma-processes"><i class="fa fa-check"></i><b>4.1</b> MA processes</a></li>
<li class="chapter" data-level="4.2" data-path="stationary-process.html"><a href="stationary-process.html#examples-3"><i class="fa fa-check"></i><b>4.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="arma-processes.html"><a href="arma-processes.html"><i class="fa fa-check"></i><b>5</b> ARMA processes</a>
<ul>
<li class="chapter" data-level="5.1" data-path="arma-processes.html"><a href="arma-processes.html#ar-process"><i class="fa fa-check"></i><b>5.1</b> AR process</a></li>
<li class="chapter" data-level="5.2" data-path="arma-processes.html"><a href="arma-processes.html#arma-process"><i class="fa fa-check"></i><b>5.2</b> ARMA process</a></li>
<li class="chapter" data-level="5.3" data-path="arma-processes.html"><a href="arma-processes.html#examples-4"><i class="fa fa-check"></i><b>5.3</b> Examples</a></li>
<li class="chapter" data-level="5.4" data-path="arma-processes.html"><a href="arma-processes.html#comparing-ar-ma-and-arma"><i class="fa fa-check"></i><b>5.4</b> Comparing AR, MA and ARMA</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="arima-and-seasonal-arima-sarima.html"><a href="arima-and-seasonal-arima-sarima.html"><i class="fa fa-check"></i><b>6</b> ARIMA and seasonal ARIMA (sARIMA)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="arima-and-seasonal-arima-sarima.html"><a href="arima-and-seasonal-arima-sarima.html#unit-root-test"><i class="fa fa-check"></i><b>6.1</b> Unit root test</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="arima-and-seasonal-arima-sarima.html"><a href="arima-and-seasonal-arima-sarima.html#kpss-test"><i class="fa fa-check"></i><b>6.1.1</b> KPSS test</a></li>
<li class="chapter" data-level="6.1.2" data-path="arima-and-seasonal-arima-sarima.html"><a href="arima-and-seasonal-arima-sarima.html#adf-test"><i class="fa fa-check"></i><b>6.1.2</b> ADF test</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="arima-and-seasonal-arima-sarima.html"><a href="arima-and-seasonal-arima-sarima.html#seasonal-arima"><i class="fa fa-check"></i><b>6.2</b> Seasonal ARIMA</a>
<ul>
<li class="chapter" data-level="" data-path="arima-and-seasonal-arima-sarima.html"><a href="arima-and-seasonal-arima-sarima.html#step-1-how-many-times-should-i-apply-a-seasonal-differencing"><i class="fa fa-check"></i><strong>Step 1</strong>: How many times should I apply a seasonal differencing?</a></li>
<li class="chapter" data-level="" data-path="arima-and-seasonal-arima-sarima.html"><a href="arima-and-seasonal-arima-sarima.html#step-2-how-many-times-should-i-apply-a-first-differencing"><i class="fa fa-check"></i><strong>Step 2</strong>: How many times should I apply a first differencing?</a></li>
<li class="chapter" data-level="" data-path="arima-and-seasonal-arima-sarima.html"><a href="arima-and-seasonal-arima-sarima.html#step-3-apply-sarma-models-to-stationary-series."><i class="fa fa-check"></i><strong>Step 3</strong>: Apply SARMA models to stationary series.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="arima-and-seasonal-arima-sarima.html"><a href="arima-and-seasonal-arima-sarima.html#automatic-arima"><i class="fa fa-check"></i><b>6.3</b> Automatic ARIMA</a></li>
<li class="chapter" data-level="6.4" data-path="arima-and-seasonal-arima-sarima.html"><a href="arima-and-seasonal-arima-sarima.html#output2equations"><i class="fa fa-check"></i><b>6.4</b> Output2Equations</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="arima-with-predictors.html"><a href="arima-with-predictors.html"><i class="fa fa-check"></i><b>7</b> ARIMA with predictors</a>
<ul>
<li class="chapter" data-level="7.1" data-path="arima-with-predictors.html"><a href="arima-with-predictors.html#how-to-make-predictors"><i class="fa fa-check"></i><b>7.1</b> How to make predictors?</a></li>
<li class="chapter" data-level="7.2" data-path="arima-with-predictors.html"><a href="arima-with-predictors.html#using-lags"><i class="fa fa-check"></i><b>7.2</b> Using lags</a></li>
<li class="chapter" data-level="7.3" data-path="arima-with-predictors.html"><a href="arima-with-predictors.html#using-function-of-lags"><i class="fa fa-check"></i><b>7.3</b> Using function of lags</a></li>
<li class="chapter" data-level="7.4" data-path="arima-with-predictors.html"><a href="arima-with-predictors.html#time-predictors"><i class="fa fa-check"></i><b>7.4</b> Time predictors</a></li>
<li class="chapter" data-level="7.5" data-path="arima-with-predictors.html"><a href="arima-with-predictors.html#trend-predictors"><i class="fa fa-check"></i><b>7.5</b> Trend predictors</a></li>
<li class="chapter" data-level="7.6" data-path="arima-with-predictors.html"><a href="arima-with-predictors.html#seasonal-and-holidays-dummies"><i class="fa fa-check"></i><b>7.6</b> Seasonal and holidays dummies</a></li>
<li class="chapter" data-level="7.7" data-path="arima-with-predictors.html"><a href="arima-with-predictors.html#sin-and-cos-over-time"><i class="fa fa-check"></i><b>7.7</b> Sin and Cos over time</a></li>
<li class="chapter" data-level="7.8" data-path="arima-with-predictors.html"><a href="arima-with-predictors.html#arima-and-predictors"><i class="fa fa-check"></i><b>7.8</b> ARIMA and predictors</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="arima-with-predictors.html"><a href="arima-with-predictors.html#example-1-1"><i class="fa fa-check"></i><b>7.8.1</b> Example 1</a></li>
<li class="chapter" data-level="7.8.2" data-path="arima-with-predictors.html"><a href="arima-with-predictors.html#example-2.-daily-data"><i class="fa fa-check"></i><b>7.8.2</b> Example 2. Daily data</a></li>
<li class="chapter" data-level="7.8.3" data-path="arima-with-predictors.html"><a href="arima-with-predictors.html#example-3-1"><i class="fa fa-check"></i><b>7.8.3</b> Example 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="missing-values-anomalies-structural-shift.html"><a href="missing-values-anomalies-structural-shift.html"><i class="fa fa-check"></i><b>8</b> Missing values, anomalies, structural shift</a>
<ul>
<li class="chapter" data-level="8.1" data-path="missing-values-anomalies-structural-shift.html"><a href="missing-values-anomalies-structural-shift.html#missing-values"><i class="fa fa-check"></i><b>8.1</b> Missing values</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="missing-values-anomalies-structural-shift.html"><a href="missing-values-anomalies-structural-shift.html#imputation-with-linear-interpolation"><i class="fa fa-check"></i><b>8.1.1</b> Imputation with linear interpolation</a></li>
<li class="chapter" data-level="8.1.2" data-path="missing-values-anomalies-structural-shift.html"><a href="missing-values-anomalies-structural-shift.html#arima-imputation"><i class="fa fa-check"></i><b>8.1.2</b> ARIMA imputation</a></li>
<li class="chapter" data-level="8.1.3" data-path="missing-values-anomalies-structural-shift.html"><a href="missing-values-anomalies-structural-shift.html#imputation-with-stl-decomposition"><i class="fa fa-check"></i><b>8.1.3</b> Imputation with STL decomposition</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="missing-values-anomalies-structural-shift.html"><a href="missing-values-anomalies-structural-shift.html#outliers-and-anomalies"><i class="fa fa-check"></i><b>8.2</b> Outliers and anomalies</a></li>
<li class="chapter" data-level="8.3" data-path="missing-values-anomalies-structural-shift.html"><a href="missing-values-anomalies-structural-shift.html#structural-shift"><i class="fa fa-check"></i><b>8.3</b> Structural shift</a></li>
<li class="chapter" data-level="8.4" data-path="missing-values-anomalies-structural-shift.html"><a href="missing-values-anomalies-structural-shift.html#bayesian-structural-model"><i class="fa fa-check"></i><b>8.4</b> Bayesian Structural Model</a></li>
<li class="chapter" data-level="8.5" data-path="missing-values-anomalies-structural-shift.html"><a href="missing-values-anomalies-structural-shift.html#causal-impact"><i class="fa fa-check"></i><b>8.5</b> Causal impact</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="questions-and-answers.html"><a href="questions-and-answers.html"><i class="fa fa-check"></i><b>9</b> Questions and answers</a>
<ul>
<li class="chapter" data-level="9.1" data-path="questions-and-answers.html"><a href="questions-and-answers.html#multiseasonality"><i class="fa fa-check"></i><b>9.1</b> Multiseasonality</a></li>
<li class="chapter" data-level="9.2" data-path="questions-and-answers.html"><a href="questions-and-answers.html#crostons-algorithm"><i class="fa fa-check"></i><b>9.2</b> Croston’s Algorithm</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/daluchkin?tab=repositories">All Repositories</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied statistics: Time series analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ets-model-variations" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> ETS model variations<a href="ets-model-variations.html#ets-model-variations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="ets-model-variations.html#cb111-1" tabindex="-1"></a><span class="co"># Libraries loading</span></span>
<span id="cb111-2"><a href="ets-model-variations.html#cb111-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb111-3"><a href="ets-model-variations.html#cb111-3" tabindex="-1"></a><span class="fu">library</span>(fpp3)</span>
<span id="cb111-4"><a href="ets-model-variations.html#cb111-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb111-5"><a href="ets-model-variations.html#cb111-5" tabindex="-1"></a><span class="fu">library</span>(rio)</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="ets-model-variations.html#cb112-1" tabindex="-1"></a><span class="co"># data loading</span></span>
<span id="cb112-2"><a href="ets-model-variations.html#cb112-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="fu">paste0</span>(<span class="fu">getwd</span>(), <span class="st">&#39;/00_data/marriages.csv&#39;</span>))</span>
<span id="cb112-3"><a href="ets-model-variations.html#cb112-3" tabindex="-1"></a><span class="fu">glimpse</span>(m)</span></code></pre></div>
<pre><code>## Rows: 24,852
## Columns: 4
## $ code  &lt;int64&gt; 1000000000, 1000000000, 1000000000, 1000000000, 1000000000, 1000000000, 1000000000, 1000000000, 1000000000, 1000000000, 1000000000, 1000000000, 1…
## $ name  &lt;chr&gt; &quot;Алтайский край&quot;, &quot;Алтайский край&quot;, &quot;Алтайский край&quot;, &quot;Алтайский край&quot;, &quot;Алтайский край&quot;, &quot;Алтайский край&quot;, &quot;Алтайский край&quot;, &quot;Алтайский край&quot;, &quot;Ал…
## $ total &lt;int&gt; 953, 1007, 1311, 1554, 562, 1900, 2338, 3034, 2460, 1762, 1411, 1554, 1069, 1221, 1330, 1774, 609, 2107, 2708, 3272, 2483, 1825, 1721, 1940, 1006, …
## $ date  &lt;IDate&gt; 2006-01-01, 2006-02-01, 2006-03-01, 2006-04-01, 2006-05-01, 2006-06-01, 2006-07-01, 2006-08-01, 2006-09-01, 2006-10-01, 2006-11-01, 2006-12-01, 2…</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="ets-model-variations.html#cb114-1" tabindex="-1"></a>ts_marriages <span class="ot">&lt;-</span> m <span class="sc">|&gt;</span></span>
<span id="cb114-2"><a href="ets-model-variations.html#cb114-2" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">yearmonth</span>(date)) <span class="sc">|&gt;</span></span>
<span id="cb114-3"><a href="ets-model-variations.html#cb114-3" tabindex="-1"></a>                <span class="fu">as_tsibble</span>(<span class="at">index =</span> date, <span class="at">key =</span> <span class="fu">c</span>(<span class="st">&#39;code&#39;</span>, <span class="st">&#39;name&#39;</span>))</span>
<span id="cb114-4"><a href="ets-model-variations.html#cb114-4" tabindex="-1"></a><span class="fu">glimpse</span>(ts_marriages)</span></code></pre></div>
<pre><code>## Rows: 24,852
## Columns: 4
## Key: code, name [109]
## $ code  &lt;int64&gt; 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 3…
## $ name  &lt;chr&gt; &quot;Центральный федеральный округ&quot;, &quot;Центральный федеральный округ&quot;, &quot;Центральный федеральный округ&quot;, &quot;Центральный федеральный округ&quot;, &quot;Центральный фе…
## $ total &lt;int&gt; 14845, 16414, 15753, 21803, 9384, 29571, 35691, 39263, 40480, 24137, 21207, 19009, 15433, 17430, 13878, 29703, 10529, 31572, 41328, 42609, 41779, 2…
## $ date  &lt;mth&gt; 2006 Jan, 2006 Feb, 2006 Mar, 2006 Apr, 2006 May, 2006 Jun, 2006 Jul, 2006 Aug, 2006 Sep, 2006 Oct, 2006 Nov, 2006 Dec, 2007 Jan, 2007 Feb, 2007 Ma…</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="ets-model-variations.html#cb116-1" tabindex="-1"></a>rf_m <span class="ot">&lt;-</span> ts_marriages <span class="sc">|&gt;</span></span>
<span id="cb116-2"><a href="ets-model-variations.html#cb116-2" tabindex="-1"></a>  <span class="fu">filter</span>(code <span class="sc">==</span> <span class="dv">643</span>, <span class="sc">!</span><span class="fu">is.na</span>(total))</span></code></pre></div>
<div id="etsaadn-damped-trend" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> ETS(AAdN): damped trend<a href="ets-model-variations.html#etsaadn-damped-trend" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In an <strong>ETS model</strong> with a <strong>damped trend</strong>, a special coefficient is
added to allow the trend’s growth or decline to slow down over time.
This is useful when you expect that the trend will not continue to grow
or decrease at the same rate indefinitely but instead will gradually
slow down.</p>
<p>A <strong>damping parameter</strong> <span class="math inline">\(\phi\)</span> is introduced, which lies between 0
and 1. This parameter controls how the trend slows down. - If
<span class="math inline">\(\phi = 1\)</span>, the trend remains additive (linear) and is not damped. - If
<span class="math inline">\(\phi &lt; 1\)</span>, the trend gradually reduces, slowing down over time.</p>
<p>In an <strong>ETS(AAdN)</strong> model (<strong>A</strong>dditive Error, <strong>A</strong>dditive <strong>d</strong>amped
Trend, <strong>N</strong>o Seasonality), the model is described as follows:</p>
<p><span class="math display">\[
\begin{cases}
y_t = \ell_{t-1} + \phi b _{t-1} + \beta u_t \\
b_t = \phi b _{t-1} + \beta u_t, b_0 - \text {start value} \\
l_t = \ell_{t-1} + \phi b _{t-1} + \alpha u_t, \ell_0 - \text {start value} \\
u_t \sim \mathcal{N}(0,\,\sigma^{2}) \text { and independent}
\end{cases}
\]</span></p>
<p>Parameters: <span class="math inline">\(\alpha, \sigma^2, \ell_0, b_0, \beta, \phi\)</span><br />
</p>
<div id="forecast-3" class="section level3 unnumbered hasAnchor">
<h3>Forecast<a href="ets-model-variations.html#forecast-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="one-step-forecast-3" class="section level4 unnumbered hasAnchor">
<h4>One-step forecast<a href="ets-model-variations.html#one-step-forecast-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
y_{T+1} = \ell_T + \phi b_T + u_{T+1}
\]</span></p>
<p><span class="math display">\[
(y_{T+1}|\mathcal{F_T}) \sim \mathcal{N}(l_T + \phi b_T, \sigma^2)
\]</span></p>
</div>
<div id="two-step-forecast-3" class="section level4 unnumbered hasAnchor">
<h4>Two-step forecast<a href="ets-model-variations.html#two-step-forecast-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
y_{T+2} = l_{T+1} + \phi b_{T+1} + u_{T+2} = (l_T + \phi b_T + \alpha u_{T+1}) + \phi(\phi b_T + \beta u_{T+1}) + u_{T+2}
\]</span></p>
<p><span class="math display">\[
(y_{T+2}|\mathcal{F_T}) \sim \mathcal{N}(l_T + (\phi + \phi^2)b_T, \sigma^2((\alpha + \phi \beta)^2 + 1))
\]</span></p>
</div>
</div>
<div id="example-3" class="section level3 unnumbered hasAnchor">
<h3>Example<a href="ets-model-variations.html#example-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="ets-model-variations.html#cb117-1" tabindex="-1"></a>rf_y <span class="ot">&lt;-</span> rf_m <span class="sc">|&gt;</span></span>
<span id="cb117-2"><a href="ets-model-variations.html#cb117-2" tabindex="-1"></a>  <span class="fu">index_by</span>(<span class="fu">year</span>(date)) <span class="sc">|&gt;</span></span>
<span id="cb117-3"><a href="ets-model-variations.html#cb117-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">sum</span>(total)) <span class="sc">|&gt;</span></span>
<span id="cb117-4"><a href="ets-model-variations.html#cb117-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">year(date)</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">2021</span>)</span>
<span id="cb117-5"><a href="ets-model-variations.html#cb117-5" tabindex="-1"></a></span>
<span id="cb117-6"><a href="ets-model-variations.html#cb117-6" tabindex="-1"></a>rf_y<span class="sc">|&gt;</span></span>
<span id="cb117-7"><a href="ets-model-variations.html#cb117-7" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(total <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&#39;A&#39;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&#39;Ad&#39;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&#39;N&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb117-8"><a href="ets-model-variations.html#cb117-8" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb117-9"><a href="ets-model-variations.html#cb117-9" tabindex="-1"></a>  <span class="fu">autoplot</span>(rf_y) <span class="sc">+</span></span>
<span id="cb117-10"><a href="ets-model-variations.html#cb117-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;ETS(AAdN): mariages in Russia&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Mariages&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/03-exponential-smoothing-5-1.png" width="672" /></p>
</div>
</div>
<div id="etsmnm-multiplicative-components" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> ETS(MNM): multiplicative components<a href="ets-model-variations.html#etsmnm-multiplicative-components" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>ETS</strong> - <strong>E</strong>rror, <strong>T</strong>rend, <strong>S</strong>easonality.<br />
<strong>MNM</strong> - <strong>M</strong>ultiplicative error, <strong>N</strong>o trend, <strong>M</strong>o seasonality.</p>
<p><span class="math display">\[
\begin{cases}
y_t = l_{t-1} \times s_{t-12} \times (1 + u_t) \\
l_t = l_{t-1} \times (1 + \alpha u_t), l_0 - \text {start value} \\
s_t = s_{t-12} \times (1 + \gamma u_t), s_0, ..., s_{-11} - \text {start values} \\
u_t \sim \mathcal{N}(0,\,\sigma^{2}) \text { and independent}
\end{cases}
\]</span></p>
<ul>
<li><span class="math inline">\(y_t\)</span> - observed value at time <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(\ell_t\)</span> - trend, or level at time <span class="math inline">\(T\)</span></li>
<li><span class="math inline">\(s_t\)</span> - seasonal component</li>
<li><span class="math inline">\(u_t\)</span> - random error</li>
</ul>
<div id="parameters" class="section level3 unnumbered hasAnchor">
<h3>Parameters<a href="ets-model-variations.html#parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Non-seasonal parameters: <span class="math inline">\(\alpha, \sigma^2, l_0\)</span></li>
<li>Seasonal parameters: <span class="math inline">\(\gamma, s_0, s_{-1},..., s_{-11}\)</span></li>
</ul>
<p>Limitation: <span class="math inline">\(s_0 \times s_{-1} \times...\times s_{-11} = 1\)</span></p>
<ul>
<li><span class="math inline">\(y_t, \ell_t\)</span> - original units</li>
<li><span class="math inline">\(s_t, u_t\)</span> - fraction</li>
<li><span class="math inline">\(s_t\)</span> is measured relative to one, for example, <span class="math inline">\(s_t = 0.9\)</span> means it
is 10% below the trend.</li>
<li><span class="math inline">\(u_t\)</span> is measured relative to zero, for example, <span class="math inline">\(u_t = -0.1\)</span> means
a 10% decrease.</li>
</ul>
</div>
<div id="forecast-4" class="section level3 unnumbered hasAnchor">
<h3>Forecast<a href="ets-model-variations.html#forecast-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="one-step-forecast-4" class="section level4 unnumbered hasAnchor">
<h4>One-step forecast<a href="ets-model-variations.html#one-step-forecast-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
y_{T+1} = l_T \times s_{T-11} \times (1 + u_{T+1})
\]</span></p>
<p><span class="math display">\[
(y_{T+1}|\mathcal{F_T}) \sim \mathcal{N}(\ell_T \times s_{T-11}, (\ell_T \times s_{T-11})^2\sigma^2)
\]</span></p>
</div>
<div id="two-step-forecast-4" class="section level4 unnumbered hasAnchor">
<h4>Two-step forecast<a href="ets-model-variations.html#two-step-forecast-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
y_{T+2} = l_{T+1} \times s_{T-10} \times (1+u_{T+2}) = l_T (1+ \alpha u_{T+1}) \times s_{T-10} \times (1 + u_{T+2})
\]</span></p>
</div>
</div>
<div id="example-4" class="section level3 unnumbered hasAnchor">
<h3>Example<a href="ets-model-variations.html#example-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="ets-model-variations.html#cb118-1" tabindex="-1"></a>fc1 <span class="ot">&lt;-</span> aus_production <span class="sc">|&gt;</span></span>
<span id="cb118-2"><a href="ets-model-variations.html#cb118-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&lt;</span> <span class="dv">1970</span>) <span class="sc">|&gt;</span></span>
<span id="cb118-3"><a href="ets-model-variations.html#cb118-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Electricity <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&#39;M&#39;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&#39;N&#39;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&#39;M&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb118-4"><a href="ets-model-variations.html#cb118-4" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">16</span>)</span>
<span id="cb118-5"><a href="ets-model-variations.html#cb118-5" tabindex="-1"></a></span>
<span id="cb118-6"><a href="ets-model-variations.html#cb118-6" tabindex="-1"></a>fc2 <span class="ot">&lt;-</span> aus_production <span class="sc">|&gt;</span></span>
<span id="cb118-7"><a href="ets-model-variations.html#cb118-7" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&lt;</span> <span class="dv">1980</span>) <span class="sc">|&gt;</span></span>
<span id="cb118-8"><a href="ets-model-variations.html#cb118-8" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Electricity <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&#39;M&#39;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&#39;N&#39;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&#39;M&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb118-9"><a href="ets-model-variations.html#cb118-9" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">16</span>)</span>
<span id="cb118-10"><a href="ets-model-variations.html#cb118-10" tabindex="-1"></a></span>
<span id="cb118-11"><a href="ets-model-variations.html#cb118-11" tabindex="-1"></a>aus_production <span class="sc">|&gt;</span></span>
<span id="cb118-12"><a href="ets-model-variations.html#cb118-12" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&lt;</span> <span class="dv">1980</span>) <span class="sc">|&gt;</span></span>
<span id="cb118-13"><a href="ets-model-variations.html#cb118-13" tabindex="-1"></a>  <span class="fu">autoplot</span>(Electricity) <span class="sc">+</span></span>
<span id="cb118-14"><a href="ets-model-variations.html#cb118-14" tabindex="-1"></a>  <span class="fu">autolayer</span>(fc1) <span class="sc">+</span></span>
<span id="cb118-15"><a href="ets-model-variations.html#cb118-15" tabindex="-1"></a>  <span class="fu">autolayer</span>(fc2) <span class="sc">+</span></span>
<span id="cb118-16"><a href="ets-model-variations.html#cb118-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;ETS(MNM): electricity production in Australia&#39;</span>)</span></code></pre></div>
<pre><code>## Scale for fill_ramp is already present.
## Adding another scale for fill_ramp, which will replace the existing scale.</code></pre>
<p><img src="_main_files/figure-html/03-exponential-smoothing-6-1.png" width="672" /></p>
</div>
</div>
<div id="etsmadm-combinations" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> ETS(MAdM): combinations<a href="ets-model-variations.html#etsmadm-combinations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>MAdM</strong>: <strong>M</strong>ultiplicative error, <strong>A</strong>dditive <strong>d</strong>umped trend,
<strong>M</strong>ultiplicative seasonality</p>
<p><span class="math display">\[
\begin{cases}
y_t = (l_{t-1} + \phi b_{t-1}) \times s_{t-12} \times (1 + u_t) \\
l_t = (l_{t-1} + \phi b_{t-1}) \times (1 + \alpha u_t), l_0 - \text {start value} \\
b_t = \phi b_{t-1} + \beta(l_{t-1} + \phi b_{t-1})u_t, b_0 - \text {start value}\\
s_t = s_{t-12} \times (1 + \gamma u_t), s_0, ..., s_{-11} - \text {start values} \\
u_t \sim \mathcal{N}(0,\,\sigma^{2}) \text { and independent}
\end{cases}
\]</span></p>
<div id="parameters-1" class="section level3 unnumbered hasAnchor">
<h3>Parameters<a href="ets-model-variations.html#parameters-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Non-seasonal parameters: <span class="math inline">\(\alpha, \beta, \sigma, \phi, l_0, b_0\)</span></li>
<li>Seasonal parameters: <span class="math inline">\(\gamma, s_0, s_{-1}, ... , s_{-11}\)</span></li>
</ul>
</div>
<div id="forecast-5" class="section level3 unnumbered hasAnchor">
<h3>Forecast<a href="ets-model-variations.html#forecast-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="one-step-forecast-5" class="section level4 unnumbered hasAnchor">
<h4>One-step forecast<a href="ets-model-variations.html#one-step-forecast-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
y_{T+1} = (l_T + \phi b_T) \times s_{T-11} \times (1 + u_{T+1})
\]</span></p>
<p><span class="math display">\[
(y_{T+1}|\mathcal{F_T}) \sim \mathcal{N}((\ell_T + \phi b_T) \times s_{T-11}, (\ell_T + \phi b_T)^2 \times s_{T-11}^2 \times \sigma^2)
\]</span></p>
</div>
</div>
<div id="example-5" class="section level3 unnumbered hasAnchor">
<h3>Example<a href="ets-model-variations.html#example-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="ets-model-variations.html#cb120-1" tabindex="-1"></a>rf_m <span class="sc">|&gt;</span></span>
<span id="cb120-2"><a href="ets-model-variations.html#cb120-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(date) <span class="sc">&gt;</span> <span class="dv">2012</span>, <span class="fu">year</span>(date) <span class="sc">&lt;</span> <span class="dv">2022</span>) <span class="sc">|&gt;</span></span>
<span id="cb120-3"><a href="ets-model-variations.html#cb120-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(total <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&#39;M&#39;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&#39;Ad&#39;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&#39;M&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb120-4"><a href="ets-model-variations.html#cb120-4" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">48</span>) <span class="sc">|&gt;</span></span>
<span id="cb120-5"><a href="ets-model-variations.html#cb120-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(rf_m) <span class="sc">+</span></span>
<span id="cb120-6"><a href="ets-model-variations.html#cb120-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;EST(MAdM): forecast&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/03-exponential-smoothing-7-1.png" width="672" /></p>
<p>Combinations:</p>
<ul>
<li><strong>Errors:</strong> A, M</li>
<li><strong>Trend:</strong> N, A, Ad, M, Md</li>
<li><strong>Seasonality:</strong> N, A, M</li>
</ul>
<p>Historic naming:</p>
<ul>
<li><strong>ETS(ANN)</strong> - Simple Exponential Smoothing</li>
<li><strong>ETS(AAA)</strong> - Additive Holt-Winters Method</li>
<li><strong>ETS(AAM)</strong> - Multiplicative Holt-Winters Method</li>
<li><strong>ETS(AAdM)</strong> - Damped Additive Trend with Multiplicative Seasonality
(Damped Holt-Winters)</li>
</ul>
</div>
</div>
<div id="examples-2" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Examples<a href="ets-model-variations.html#examples-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="ets-model-variations.html#cb121-1" tabindex="-1"></a>rf_m <span class="sc">|&gt;</span></span>
<span id="cb121-2"><a href="ets-model-variations.html#cb121-2" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(total)</span></code></pre></div>
<p><img src="_main_files/figure-html/03-exponential-smoothing-8-1.png" width="672" /></p>
<p>Split into training and test set.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="ets-model-variations.html#cb122-1" tabindex="-1"></a>rf_train <span class="ot">&lt;-</span> rf_m <span class="sc">|&gt;</span></span>
<span id="cb122-2"><a href="ets-model-variations.html#cb122-2" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">year</span>(date) <span class="sc">&lt;</span> <span class="dv">2020</span>)</span>
<span id="cb122-3"><a href="ets-model-variations.html#cb122-3" tabindex="-1"></a>rf_test <span class="ot">&lt;-</span> rf_m <span class="sc">|&gt;</span></span>
<span id="cb122-4"><a href="ets-model-variations.html#cb122-4" tabindex="-1"></a>  <span class="fu">anti_join</span>(rf_train, <span class="at">by =</span> <span class="st">&#39;date&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="ets-model-variations.html#cb123-1" tabindex="-1"></a>models <span class="ot">&lt;-</span> rf_train <span class="sc">|&gt;</span></span>
<span id="cb123-2"><a href="ets-model-variations.html#cb123-2" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb123-3"><a href="ets-model-variations.html#cb123-3" tabindex="-1"></a>    <span class="at">snaive =</span> <span class="fu">SNAIVE</span>(total),</span>
<span id="cb123-4"><a href="ets-model-variations.html#cb123-4" tabindex="-1"></a>    <span class="at">ANA =</span> <span class="fu">ETS</span>(total <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&#39;A&#39;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&#39;N&#39;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&#39;A&#39;</span>)),</span>
<span id="cb123-5"><a href="ets-model-variations.html#cb123-5" tabindex="-1"></a>    <span class="at">AAA =</span> <span class="fu">ETS</span>(total <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&#39;A&#39;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&#39;A&#39;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&#39;A&#39;</span>)),</span>
<span id="cb123-6"><a href="ets-model-variations.html#cb123-6" tabindex="-1"></a>    <span class="at">AAdA =</span> <span class="fu">ETS</span>(total <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&#39;A&#39;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&#39;Ad&#39;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&#39;A&#39;</span>)),</span>
<span id="cb123-7"><a href="ets-model-variations.html#cb123-7" tabindex="-1"></a>    <span class="at">zzz =</span> <span class="fu">ETS</span>(total), <span class="co"># select the best model by AIC</span></span>
<span id="cb123-8"><a href="ets-model-variations.html#cb123-8" tabindex="-1"></a>    <span class="at">azz =</span> <span class="fu">ETS</span>(total <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&#39;A&#39;</span>)),</span>
<span id="cb123-9"><a href="ets-model-variations.html#cb123-9" tabindex="-1"></a>    <span class="at">theta =</span> <span class="fu">THETA</span>(total) <span class="co"># theta method</span></span>
<span id="cb123-10"><a href="ets-model-variations.html#cb123-10" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="ets-model-variations.html#cb124-1" tabindex="-1"></a>models<span class="sc">$</span>zzz[[<span class="dv">1</span>]] <span class="sc">|&gt;</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: total 
## Model: ETS(M,N,M) 
##   Smoothing parameters:
##     alpha = 0.09614705 
##     gamma = 0.0001025139 
## 
##   Initial states:
##      l[0]      s[0]    s[-1]    s[-2]    s[-3]    s[-4]    s[-5]    s[-6]     s[-7]     s[-8]    s[-9]    s[-10]    s[-11]
##  98845.29 0.8608546 0.876489 1.033511 1.431267 1.673549 1.454279 1.274721 0.4759065 0.9107223 0.736584 0.6824381 0.5896779
## 
##   sigma^2:  0.017
## 
##      AIC     AICc      BIC 
## 4023.088 4026.246 4069.947</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="ets-model-variations.html#cb126-1" tabindex="-1"></a>models<span class="sc">$</span>theta[[<span class="dv">1</span>]] <span class="sc">|&gt;</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: total 
## Model: THETA 
## 
## Alpha: 0.1385 
## Drift: -71.6835 
## sigma^2: 141532473.0062</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="ets-model-variations.html#cb128-1" tabindex="-1"></a>fc <span class="ot">&lt;-</span> models <span class="sc">|&gt;</span></span>
<span id="cb128-2"><a href="ets-model-variations.html#cb128-2" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">72</span>)</span></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="ets-model-variations.html#cb129-1" tabindex="-1"></a>fc <span class="sc">|&gt;</span> <span class="fu">accuracy</span>(rf_m)</span></code></pre></div>
<pre><code>## Warning: The future dataset is incomplete, incomplete out-of-sample data will be treated as missing. 
## 19 observations are missing between 2024 Jun and 2025 Dec</code></pre>
<pre><code>## # A tibble: 7 × 12
##   .model    code name                 .type      ME   RMSE    MAE    MPE  MAPE  MASE RMSSE  ACF1
##   &lt;chr&gt;  &lt;int64&gt; &lt;chr&gt;                &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 AAA        643 Российская Федерация Test   9524.  20089. 16578. 14.3    26.1 1.37  1.25  0.534
## 2 AAdA       643 Российская Федерация Test   2156.  16373. 12366.  3.07   19.2 1.02  1.02  0.458
## 3 ANA        643 Российская Федерация Test    -57.3 16139. 11922. -0.401  18.4 0.987 1.01  0.452
## 4 azz        643 Российская Федерация Test    -57.3 16139. 11922. -0.401  18.4 0.987 1.01  0.452
## 5 snaive     643 Российская Федерация Test  -1987.  14026. 10311. -7.60   17.0 0.853 0.874 0.470
## 6 theta      643 Российская Федерация Test    115.  14283. 10025. -4.25   16.5 0.830 0.890 0.545
## 7 zzz        643 Российская Федерация Test  -1830.  14036. 10206. -6.92   16.9 0.845 0.874 0.500</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="ets-model-variations.html#cb132-1" tabindex="-1"></a>rf_m <span class="sc">|&gt;</span></span>
<span id="cb132-2"><a href="ets-model-variations.html#cb132-2" tabindex="-1"></a>  <span class="fu">autoplot</span>(total) <span class="sc">+</span></span>
<span id="cb132-3"><a href="ets-model-variations.html#cb132-3" tabindex="-1"></a>  <span class="fu">autolayer</span>(fc) <span class="sc">+</span></span>
<span id="cb132-4"><a href="ets-model-variations.html#cb132-4" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.model <span class="sc">~</span> .)</span></code></pre></div>
<p><img src="_main_files/figure-html/03-exponential-smoothing-15-1.png" width="576" />
Composite model.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="ets-model-variations.html#cb133-1" tabindex="-1"></a>models <span class="ot">&lt;-</span> rf_train <span class="sc">|&gt;</span></span>
<span id="cb133-2"><a href="ets-model-variations.html#cb133-2" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb133-3"><a href="ets-model-variations.html#cb133-3" tabindex="-1"></a>    <span class="at">snaive =</span> <span class="fu">SNAIVE</span>(total),</span>
<span id="cb133-4"><a href="ets-model-variations.html#cb133-4" tabindex="-1"></a>    <span class="at">theta =</span> <span class="fu">THETA</span>(total),</span>
<span id="cb133-5"><a href="ets-model-variations.html#cb133-5" tabindex="-1"></a>    <span class="at">composit =</span> <span class="fu">decomposition_model</span>(</span>
<span id="cb133-6"><a href="ets-model-variations.html#cb133-6" tabindex="-1"></a>      <span class="fu">STL</span>(total <span class="sc">~</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="cn">Inf</span>)),</span>
<span id="cb133-7"><a href="ets-model-variations.html#cb133-7" tabindex="-1"></a>      <span class="fu">ETS</span>(season_adjust <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&#39;A&#39;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&#39;Ad&#39;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&#39;N&#39;</span>)),</span>
<span id="cb133-8"><a href="ets-model-variations.html#cb133-8" tabindex="-1"></a>      <span class="fu">SNAIVE</span>(season_year) ))</span></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="ets-model-variations.html#cb134-1" tabindex="-1"></a>models <span class="sc">|&gt;</span></span>
<span id="cb134-2"><a href="ets-model-variations.html#cb134-2" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">48</span>) <span class="sc">|&gt;</span></span>
<span id="cb134-3"><a href="ets-model-variations.html#cb134-3" tabindex="-1"></a>  <span class="fu">accuracy</span>(rf_m)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 12
##   .model      code name                 .type      ME   RMSE    MAE   MPE  MAPE  MASE RMSSE  ACF1
##   &lt;chr&gt;    &lt;int64&gt; &lt;chr&gt;                &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 composit     643 Российская Федерация Test   3863.  17186. 13390.  4.97  20.4 1.11  1.07  0.490
## 2 snaive       643 Российская Федерация Test  -2213.  14571. 10717. -8.33  17.6 0.887 0.908 0.479
## 3 theta        643 Российская Федерация Test    -42.7 14814. 10474. -4.98  17.0 0.867 0.923 0.567</code></pre>
<p>Model evaluation for multiple time series.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="ets-model-variations.html#cb136-1" tabindex="-1"></a>train <span class="ot">&lt;-</span> ts_marriages <span class="sc">|&gt;</span></span>
<span id="cb136-2"><a href="ets-model-variations.html#cb136-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(date) <span class="sc">&lt;</span> <span class="dv">2020</span>)</span></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="ets-model-variations.html#cb137-1" tabindex="-1"></a>models <span class="ot">&lt;-</span> train <span class="sc">|&gt;</span></span>
<span id="cb137-2"><a href="ets-model-variations.html#cb137-2" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb137-3"><a href="ets-model-variations.html#cb137-3" tabindex="-1"></a>    <span class="at">snaive =</span> <span class="fu">SNAIVE</span>(total),</span>
<span id="cb137-4"><a href="ets-model-variations.html#cb137-4" tabindex="-1"></a>    <span class="at">zzz =</span> <span class="fu">ETS</span>(<span class="fu">log</span>(total)), <span class="co"># select the best model by AIC</span></span>
<span id="cb137-5"><a href="ets-model-variations.html#cb137-5" tabindex="-1"></a>    <span class="at">theta =</span> <span class="fu">THETA</span>(total)</span>
<span id="cb137-6"><a href="ets-model-variations.html#cb137-6" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: 22 errors (2 unique) encountered for zzz
## [21] ETS does not support missing values.
## [1] NA/NaN/Inf in &#39;y&#39;</code></pre>
<pre><code>## Warning: 21 errors (1 unique) encountered for theta
## [21] missing values in object</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="ets-model-variations.html#cb140-1" tabindex="-1"></a>acc <span class="ot">&lt;-</span> models <span class="sc">|&gt;</span></span>
<span id="cb140-2"><a href="ets-model-variations.html#cb140-2" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">48</span>) <span class="sc">|&gt;</span> </span>
<span id="cb140-3"><a href="ets-model-variations.html#cb140-3" tabindex="-1"></a>  <span class="fu">accuracy</span>(rf_m)</span></code></pre></div>
<pre><code>## Warning: The future dataset is incomplete, incomplete out-of-sample data will be treated as missing. 
## 48 observations are missing between 2020 Jan and 2023 Dec</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="ets-model-variations.html#cb142-1" tabindex="-1"></a>acc <span class="sc">|&gt;</span></span>
<span id="cb142-2"><a href="ets-model-variations.html#cb142-2" tabindex="-1"></a>  <span class="fu">group_by</span>(.model) <span class="sc">|&gt;</span></span>
<span id="cb142-3"><a href="ets-model-variations.html#cb142-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_MAE =</span> <span class="fu">mean</span>(MAE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   .model avg_MAE
##   &lt;chr&gt;    &lt;dbl&gt;
## 1 snaive  74637.
## 2 theta   74759.
## 3 zzz     74672.</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exponential-smoothing-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stationary-process.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
